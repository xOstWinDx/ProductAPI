## Приложение на FastAPI

Это приложение на FastAPI позволяет пользователям регистрироваться, аутентифицироваться и авторизовываться. Пользователи могут добавлять продукты, выполнять поиск по продуктам с использованием фильтров и пагинации, а также, если у них есть права администратора, удалять и изменять существующие в базе данных продукты.

### Функциональные возможности

- **Регистрация пользователей**: Создание нового пользовательского аккаунта.
- **Аутентификация**: Вход в систему с использованием учетных данных.
- **Авторизация**: Обеспечение наличия у пользователей соответствующих прав доступа.
- **Управление продуктами**: Добавление, удаление и изменение продуктов в базе данных.
- **Поиск продуктов**: Поиск продуктов с использованием различных фильтров и пагинации.

---

- *Для получения прав администратора теперь не нужно изменять базу данных вручную. При выполнении миграций по умолчанию создается суперпользователь.*

### Начало работы

Вы можете запустить это приложение локально или с использованием Docker. Следуйте приведенным ниже инструкциям для начала работы.

---

### Запуск локально

1. **Копирование и настройка переменных окружения**:
   - Скопируйте файл окружения-примера `.env-example` в `.env`:
     ```bash
     cp .env-example .env
     ```
   - Замените переменные в файле `.env` на ваши собственные данные. В том числе задайте данные для суперпользователя:
     ```env
     # Создаётся миграциями по умолчанию
     SUPERUSER_EMAIL=superuser@example.com
     SUPERUSER_NAME=SuperUser
     SUPERUSER_PASSWORD=supersecurepassword
     ```

2. **Установка зависимостей**:
   - Установите зависимости проекта с флагом для разработки:
     ```bash
     poetry install --with dev
     ```

3. **Запуск миграций Alembic**:
   - Примените миграции базы данных с использованием Alembic. При выполнении миграций будет создан суперпользователь с данными, указанными в `.env` файле:
     ```bash
     alembic upgrade head
     ```

4. **Запуск приложения**:
   - Запустите приложение FastAPI с использованием Uvicorn:
     ```bash
     uvicorn src.main:app --host 0.0.0.0 --port 8000
     ```

5. **Документация**:
   - После запуска приложения, документация будет доступна по стандартному адресу FastAPI:
     - Swagger UI: [http://127.0.0.1:8000/docs](http://127.0.0.1:8000/docs)
     - ReDoc: [http://127.0.0.1:8000/redoc](http://127.0.0.1:8000/redoc)

---

### Запуск с использованием Docker

1. **Копирование и настройка переменных окружения**:
   - Скопируйте файл окружения-примера `.env-example` в `.env-non-dev`:
     ```bash
     cp .env-example .env-non-dev
     ```
   - Замените переменные в файле `.env-non-dev` на ваши собственные данные. В том числе задайте данные для суперпользователя:
     ```env
     # Создаётся миграциями по умолчанию
     SUPERUSER_EMAIL=superuser@example.com
     SUPERUSER_NAME=SuperUser
     SUPERUSER_PASSWORD=supersecurepassword
     ```

2. **Запуск приложения с использованием Docker**:
   - Соберите и запустите Docker-контейнеры:
     ```bash
     docker-compose up --build -d
     ```

3. **Документация**:
   - После запуска приложения, документация будет доступна по стандартному адресу FastAPI:
     - Swagger UI: [http://127.0.0.1:8000/docs](http://127.0.0.1:8000/docs)
     - ReDoc: [http://127.0.0.1:8000/redoc](http://127.0.0.1:8000/redoc)

---

### Дополнительная информация

Приложение написано в архитектуре DDD, с расчётом на то что это будет большой монолитный сервис, содержащий разные представления для пользователей, такие как Бот Телеграм и HTTP Api.

Если бы проект был рассчитан на небольшой или средний микросервис, то использовалась бы архитектура, основанная на будущем подходе, как показано в [гиде по лучшим практикам FastAPI](https://github.com/zhanymkanov/fastapi-best-practices?tab=readme-ov-file#project-structure). Такой подход предполагает разделение кода по функциональным областям, четкое разделение слоев и использование асинхронного программирования для обеспечения масштабируемости и поддержки высоких нагрузок.

По умолчанию при выполнении миграций создается суперпользователь с правами администратора, и его данные задаются в `.env` файле. Вы можете сразу войти в систему под учетной записью суперпользователя, используя следующие данные:
- **Email**: `superuser@example.com`
- **Пароль**: `supersecurepassword`

Это избавит вас от необходимости вручную изменять базу данных для назначения прав администратора.

Это приложение использует PostgreSQL в качестве базы данных и Alembic для миграций базы данных. Убедитесь, что вы правильно настроили переменные окружения для подключения к базе данных и других настроек.

Если у вас возникли проблемы, проверьте логи для получения дополнительной информации или обратитесь к документации FastAPI и Docker для устранения неполадок.

---
